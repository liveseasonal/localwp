if(function(a,b,c){var d,e=a.getElementsByTagName(b)[0];a.getElementById(c)||(d=a.createElement(b),d.id=c,d.src="//connect.facebook.net/en_US/sdk.js",e.parentNode.insertBefore(d,e))}(document,"script","facebook-jssdk"),"undefined"!=typeof mkdfSocialLoginVars)var facebookAppId=mkdfSocialLoginVars.social.facebookAppId;facebookAppId&&(window.fbAsyncInit=function(){FB.init({appId:facebookAppId,cookie:!0,xfbml:!0,version:"v2.5"}),window.FB=FB}),function(a){"use strict";function b(){f(),g(),h(),i(),q()}function c(){k(),n()}function d(){}function e(){}function f(){var b=a(".mkdf-login-opener"),c=a(".mkdf-login-register-holder");if(b){var d=a(".mkdf-login-register-content");b.click(function(a){a.preventDefault(),c.fadeIn(300),c.addClass("opened")}),c.click(function(a){c.hasClass("opened")&&(c.fadeOut(300),c.removeClass("opened"))}),a(".mkdf-login-register-content").click(function(a){a.stopPropagation()}),a(window).on("keyup",function(a){c.hasClass("opened")&&27==a.keyCode&&(c.fadeOut(300),c.removeClass("opened"))}),d.tabs()}}function g(){a(".mkdf-login-form").on("submit",function(b){b.preventDefault();var c={action:"mkdf_membership_login_user",security:a(this).find("#mkdf-login-security").val(),login_data:a(this).serialize()};return a.ajax({type:"POST",data:c,url:MikadofAjaxUrl,success:function(a){var b;b=JSON.parse(a),j(b),"success"==b.status&&(window.location=b.redirect)}}),!1})}function h(){a(".mkdf-register-form").on("submit",function(b){b.preventDefault();var c={action:"mkdf_membership_register_user",security:a(this).find("#mkdf-register-security").val(),register_data:a(this).serialize()};return a.ajax({type:"POST",data:c,url:MikadofAjaxUrl,success:function(a){var b;b=JSON.parse(a),j(b),"success"==b.status&&(window.location=b.redirect)}}),!1})}function i(){var b=a(".mkdf-reset-pass-form");b.submit(function(c){c.preventDefault();var d={action:"mkdf_membership_user_lost_password",user_login:b.find("#user_reset_password_login").val()};a.ajax({type:"POST",data:d,url:MikadofAjaxUrl,success:function(a){var b=JSON.parse(a);j(b),"success"==b.status&&(window.location=b.redirect)}})})}function j(b){var c,d=a(".mkdf-membership-response-holder"),e=_.template(a(".mkdf-membership-response-template").html());c="success"===b.status?"mkdf-membership-message-succes":"mkdf-membership-message-error";var f={messageClass:c,message:b.message},g=e(f);d.html(g)}function k(){var b=a(".mkdf-facebook-login-holder");b.submit(function(a){a.preventDefault(),window.FB.login(function(a){l(a)},{scope:"email, public_profile"})})}function l(a){"connected"===a.status?m():"not_authorized"===a.status?console.log("Please log into this app"):console.log("Please log into Facebook")}function m(){console.log("Welcome! Fetching information from Facebook..."),FB.api("/me","GET",{fields:"id, name, email, link, picture"},function(b){var c=a(".mkdf-facebook-login-holder [name^=mkdf_nonce_facebook_login]").val();b.nonce=c,b.image=b.picture.data.url;var d={action:"mkdf_membership_check_facebook_user",response:b};a.ajax({type:"POST",data:d,url:MikadofAjaxUrl,success:function(a){var b;b=JSON.parse(a),j(b),"success"==b.status&&(window.location=b.redirect)}})})}function n(){if("undefined"!=typeof mkdfSocialLoginVars)var b=mkdfSocialLoginVars.social.googleClientId;if(b)gapi.load("auth2",function(){window.auth2=gapi.auth2.init({client_id:b}),o()});else{var c=a(".mkdf-google-login-holder");c.submit(function(a){a.preventDefault()})}}function o(){var b=a(".mkdf-google-login-holder");b.submit(function(a){a.preventDefault(),window.auth2.signIn(),p()})}function p(){var b=window.auth2.isSignedIn.get();if(b){var c=window.auth2.currentUser.get(),d=c.getBasicProfile(),e=a(".mkdf-google-login-holder [name^=mkdf_nonce_google_login]").val(),f={id:d.getId(),name:d.getName(),email:d.getEmail(),image:d.getImageUrl(),link:"https://plus.google.com/"+d.getId(),nonce:e},g={action:"mkdf_membership_check_google_user",response:f};a.ajax({type:"POST",data:g,url:MikadofAjaxUrl,success:function(a){var b;b=JSON.parse(a),j(b),"success"==b.status&&(window.location=b.redirect)}})}}function q(){var b=a("#mkdf-membership-update-profile-form");if(b.length){var c=b.find("button"),d=c.data("updating-text"),e=c.data("updated-text");b.on("submit",function(b){b.preventDefault();var f=c.html();c.html(d);var g={action:"mkdf_membership_update_user_profile",data:a(this).serialize()};return a.ajax({type:"POST",data:g,url:MikadofAjaxUrl,success:function(a){var b;b=JSON.parse(a),j(b),"success"==b.status?(c.html(e),window.location=b.redirect):c.html(f)}}),!1})}}var r={};"undefined"!=typeof mkdf&&(mkdf.modules.socialLogin=r),r.mkdfUserLogin=g,r.mkdfUserRegister=h,r.mkdfUserLostPassword=i,r.mkdfInitLoginWidgetModal=f,r.mkdfInitFacebookLogin=k,r.mkdfInitGooglePlusLogin=n,r.mkdfUpdateUserProfile=q,a(document).ready(b),a(window).load(c),a(window).resize(d),a(window).scroll(e)}(jQuery);